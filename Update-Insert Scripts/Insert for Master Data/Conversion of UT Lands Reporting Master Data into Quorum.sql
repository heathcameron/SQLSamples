--drop table #UTL_DATA
print ''
print 'CREATE TEMP TABLE WITH DATA'

select * INTO #UTL_DATA from ( select '115777' as 'LSE_NO', '10002J' as PROP_NO, 'NON UNIT' as PROP_NM, NULL as UNIT_NO, '100' AS PROD_CD, '1/1/2010' AS START_MO, '12/31/9999' AS END_MO, '1' AS TRACT_PAR, '0.25' AS ROY_DEC
--union select '115777', '10002J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '115777', '10003J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '111465', '10050J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '111465', '10051J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '111450', '10052J','302', '2640~3', '100', '1/1/2010', '12/31/9999', '0.491989', '0.25'
union select '111454', '10052J','306', '2640~3', '100', '1/1/2010', '12/31/9999', '0.508011', '0.25'
union select '111450', '10074J','302', '2640~3', '100', '1/1/2010', '12/31/9999', '0.491989', '0.25'
union select '111454', '10074J','306', '2640~3', '100', '1/1/2010', '12/31/9999', '0.508011', '0.25'
union select '111465', '10043J','411', '2640~4', '100', '1/1/2010', '12/31/9999', '0.473679', '0.25'
union select '111466', '10043J','412', '2640~4', '100', '1/1/2010', '12/31/9999', '0.526321', '0.25'
union select '111455', '10061J','1', '2839', '100', '1/1/2010', '12/31/9999', '0.04761952', '0.25'
union select '111454', '10061J','2', '2839', '100', '1/1/2010', '12/31/9999', '0.38109619', '0.25'
union select '111453', '10061J','3', '2839', '100', '1/1/2010', '12/31/9999', '0.19042841', '0.25'
union select '95577', '10061J','4', '2839', '100', '1/1/2010', '12/31/9999', '0.19042841', '0.2'
union select '54900', '10061J','5', '2839', '100', '1/1/2010', '12/31/9999', '0.19042841', '0.1666667'
union select '111463', '10056J','509', '2640~5', '100', '1/1/2010', '12/31/9999', '0.55', '0.25'
union select '111467', '10056J','513', '2640~5', '100', '1/1/2010', '12/31/9999', '0.45', '0.25'
union select '117768', '10057J','1', '2861', '100', '1/1/2010', '12/31/9999', '0.5', '0.25'
union select '70823', '10057J','2', '2861', '100', '1/1/2010', '12/31/9999', '0.5', '0.1666667'
union select '117768', '10128J','1', '2861', '100', '1/1/2010', '12/31/9999', '0.5', '0.25'
union select '70823', '10128J','2', '2861', '100', '1/1/2010', '12/31/9999', '0.5', '0.1666667'
union select '117768', '10158J','1', '2861', '100', '1/1/2010', '12/31/9999', '0.5', '0.25'
union select '70823', '10158J','2', '2861', '100', '1/1/2010', '12/31/9999', '0.5', '0.1666667'
union select '70826', '10076J','104', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '114589', '10076J','101', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10076J','102', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10076J','103', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '54902', '10087J','1', '2874', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '117769', '10087J','2', '2874', '100', '1/1/2010', '12/31/9999', '0.125', '0.25'
union select '96221', '10087J','3', '2874', '100', '1/1/2010', '12/31/9999', '0.125', '0.2'
union select '70825', '10087J','5', '2874', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '70824', '10087J','4', '2874', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '54902', '10088J','1', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '96221', '10088J','2', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70825', '10088J','4', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '70824', '10088J','3', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '54902', '10200J','1', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '96221', '10200J','2', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70825', '10200J','4', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '70824', '10200J','3', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '54902', '10194J','1', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '96221', '10194J','2', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70825', '10194J','4', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '70824', '10194J','3', '2867', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '70826', '10131J','104', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '114589', '10131J','101', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10131J','102', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10131J','103', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '70826', '10160J','104', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '114589', '10160J','101', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10160J','102', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10160J','103', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '70826', '10193J','104', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.1666667'
union select '114589', '10193J','101', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10193J','102', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10193J','103', '2866', '100', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '95557', '10150J','811', '2916~81', '100', '1/1/2010', '12/31/9999', '0.227883', '0.2'
union select '111453', '10150J','812', '2916~81', '100', '1/1/2010', '12/31/9999', '0.295471', '0.25'
union select '111451', '10150J','813', '2916~81', '100', '1/1/2010', '12/31/9999', '0.26561', '0.25'
union select '111452', '10150J','814', '2916~81', '100', '1/1/2010', '12/31/9999', '0.211036', '0.25'
union select '118297', '10162J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '118297', '10161J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '111456', '10211J','208', '2640~2', '100', '1/1/2010', '12/31/9999', '0.517', '0.25'
union select '111464', '10211J','210', '2640~2', '100', '1/1/2010', '12/31/9999', '0.2704', '0.25'
union select '118290', '10211J','221', '2640~2', '100', '1/1/2010', '12/31/9999', '0.2126', '0.25'
union select '111456', '10212J','108', '2640~1', '100', '1/1/2010', '12/31/9999', '0.515', '0.25'
union select '111464', '10212J','110', '2640~1', '100', '1/1/2010', '12/31/9999', '0.2757', '0.25'
union select '118290', '10212J','121', '2640~1', '100', '1/1/2010', '12/31/9999', '0.2093', '0.25'
union select '111451', '10245J','101', '3027~9868', '100', '1/1/2010', '12/31/9999', '0.25625849', '0.25'
union select '111452', '10245J','102', '3027~9868', '100', '1/1/2010', '12/31/9999', '0.23180672', '0.25'
union select '111453', '10245J','103', '3027~9868', '100', '1/1/2010', '12/31/9999', '0.25635552', '0.25'
union select '95577', '10245J','104', '3027~9868', '100', '1/1/2010', '12/31/9999', '0.25557927', '0.2'
union select '95577', '10252J','101', '3002~9874', '100', '1/1/2010', '12/31/9999', '0.25437833', '0.2'
union select '111453', '10252J','102', '3002~9874', '100', '1/1/2010', '12/31/9999', '0.25544267', '0.25'
union select '111451', '10252J','103', '3002~9874', '100', '1/1/2010', '12/31/9999', '0.25553943', '0.25'
union select '111452', '10252J','104', '3002~9874', '100', '1/1/2010', '12/31/9999', '0.23463957', '0.25'
union select '82679', '10382J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '95657', '10281J','NON UNIT', '', '100', '1/1/2010', '12/31/9999', '1', '0.25'
union select '54900', '10282J','101', '3028', '100', '1/1/2010', '12/31/9999', '0.50178727', '0.1666667'
union select '111484', '10282J','102', '3028', '100', '1/1/2010', '12/31/9999', '0.49821273', '0.25'
union select '41595', '10369J','102', '3092', '100', '1/1/2010', '12/31/9999', '0.47244409', '0.125'
union select '111465', '10369J','101', '3092', '100', '1/1/2010', '12/31/9999', '0.52755591', '0.25'
union select '41595', '10368J','102', '3093', '100', '1/1/2010', '12/31/9999', '0.49372545', '0.125'
union select '111465', '10368J','101', '3093', '100', '1/1/2010', '12/31/9999', '0.50627455', '0.25'
union select '41595', '10370J','102', '3094', '100', '1/1/2010', '12/31/9999', '0.49411314', '0.125'
union select '111465', '10370J','101', '3094', '100', '1/1/2010', '12/31/9999', '0.50588686', '0.25'
union select '111463', '10303J','101', '3068', '100', '1/1/2010', '12/31/9999', '0.47413969', '0.25'
union select '111468', '10303J','102', '3068', '100', '1/1/2010', '12/31/9999', '0.52586031', '0.25'
union select '111463', '10304J','101', '3069', '100', '1/1/2010', '12/31/9999', '0.48603796', '0.25'
union select '111468', '10304J','102', '3069', '100', '1/1/2010', '12/31/9999', '0.51396204', '0.25'
union select '111463', '10305J','101', '3070', '100', '1/1/2010', '12/31/9999', '0.48668257', '0.25'
union select '111468', '10305J','102', '3070', '100', '1/1/2010', '12/31/9999', '0.51331743', '0.25'
union select '111463', '10307J','101', '3071', '100', '1/1/2010', '12/31/9999', '0.47439161', '0.25'
union select '111468', '10307J','102', '3071', '100', '1/1/2010', '12/31/9999', '0.52560839', '0.25'
union select '111463', '10308J','101', '3072', '100', '1/1/2010', '12/31/9999', '0.47363063', '0.25'
union select '111468', '10308J','102', '3072', '100', '1/1/2010', '12/31/9999', '0.52636937', '0.25'
union select '111463', '10309J','101', '3073', '100', '1/1/2010', '12/31/9999', '0.49941296', '0.25'
union select '111468', '10309J','102', '3073', '100', '1/1/2010', '12/31/9999', '0.50058704', '0.25'
union select '111463', '10310J','101', '3074', '100', '1/1/2010', '12/31/9999', '0.47943392', '0.25'
union select '111468', '10310J','102', '3074', '100', '1/1/2010', '12/31/9999', '0.52056608', '0.25'
union select '111463', '10311J','101', '3075', '100', '1/1/2010', '12/31/9999', '0.47221655', '0.25'
union select '111468', '10311J','102', '3075', '100', '1/1/2010', '12/31/9999', '0.52778345', '0.25'
union select '111463', '10313J','101', '3078', '100', '1/1/2010', '12/31/9999', '0.48259256', '0.25'
union select '111468', '10313J','102', '3078', '100', '1/1/2010', '12/31/9999', '0.51740744', '0.25'
union select '41595', '10371J','101', '3076', '100', '1/1/2010', '12/31/9999', '0.50401453', '0.25'
union select '111465', '10371J','102', '3076', '100', '1/1/2010', '12/31/9999', '0.49598547', '0.25'
union select '117768', '10057J','1', '2861', '200', '1/1/2010', '12/31/9999', '0.5', '0.25'
union select '70823', '10057J','2', '2861', '200', '1/1/2010', '12/31/9999', '0.5', '0.2'
union select '117768', '10128J','1', '2861', '200', '1/1/2010', '12/31/9999', '0.5', '0.25'
union select '70823', '10128J','2', '2861', '200', '1/1/2010', '12/31/9999', '0.5', '0.2'
union select '117768', '10158J','1', '2861', '200', '1/1/2010', '12/31/9999', '0.5', '0.25'
union select '70823', '10158J','2', '2861', '200', '1/1/2010', '12/31/9999', '0.5', '0.2'
union select '70826', '10076J','104', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '114589', '10076J','101', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10076J','102', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10076J','103', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '54902', '10087J','1', '2874', '200', '1/1/2010', '12/31/9999', '0.25', '0.16666666'
union select '117769', '10087J','2', '2874', '200', '1/1/2010', '12/31/9999', '0.125', '0.25'
union select '96221', '10087J','3', '2874', '200', '1/1/2010', '12/31/9999', '0.125', '0.2'
union select '70825', '10087J','5', '2874', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70824', '10087J','4', '2874', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '54902', '10088J','1', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.166667'
union select '96221', '10088J','2', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70825', '10088J','4', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70824', '10088J','3', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '54902', '10200J','1', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.166667'
union select '96221', '10200J','2', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70825', '10200J','4', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70824', '10200J','3', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '54902', '10194J','1', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.166667'
union select '96221', '10194J','2', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70825', '10194J','4', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70824', '10194J','3', '2867', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '70826', '10131J','104', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '114589', '10131J','101', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10131J','102', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10131J','103', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '70826', '10160J','104', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '114589', '10160J','101', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10160J','102', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10160J','103', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '70826', '10193J','104', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.2'
union select '114589', '10193J','101', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '116424', '10193J','102', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
union select '114590', '10193J','103', '2866', '200', '1/1/2010', '12/31/9999', '0.25', '0.25'
) a 


update #UTL_DATA
set UNIT_NO = null 
where UNIT_NO = ''

print ''
print 'TRUNCATE EXISTING DATA'

truncate table [TONL_TX_TRRC_LSE_UT_MST] 

print ''
print 'INSERT NEW DATA INTO LIVE TABLE'

INSERT INTO [dbo].[TONL_TX_TRRC_LSE_UT_MST]
           ([OPER_BUS_SEG_CD]
           ,[UNIT_NO]
           ,[UNIV_LSE_NO]
           ,[EFF_DT_FROM]
           ,[EFF_DT_TO]
           ,[PROP_NO]
           ,[MAJ_PROD_CD]
           ,[TRACT_DEC]
           ,[RYL_DEC]
           ,[PROP_ALIAS]
           ,[GRS_RPT_FL]
           ,[UPDT_USER]
           ,[UPDT_DT])
select 
			'PAR' --[OPER_BUS_SEG_CD]
           ,[UNIT_NO]
           ,LSE_NO--[UNIV_LSE_NO]
           ,START_MO  --[EFF_DT_FROM]
           ,'12/31/9999' --[EFF_DT_TO]
           ,[PROP_NO]
           ,PROD_CD -- [MAJ_PROD_CD]
           ,TRACT_PAR  --[TRACT_DEC]
           ,ROY_DEC  --[RYL_DEC]
           ,PROP_NM --[PROP_ALIAS]
           ,'N' --[GRS_RPT_FL]
           ,'SCRIPT' --[UPDT_USER]
           , '6/22/020'
from #UTL_DATA

print ''
print 'DROP TEMP TABLE' 

drop table #UTL_DATA